# üèÜ –°–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ "–ö—Ä–∏–º–∏–Ω–∞–ª—å–Ω—ã–π –ë–ª–µ—Ñ"

## –û–±–∑–æ—Ä

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TB
    A[LeaderboardService] --> B[Leaderboard Model]
    A --> C[User Model]
    B --> D[MongoDB - leaderboard collection]
    C --> E[MongoDB - users collection]
    
    F[API Routes] --> A
    G[Automatic Updates] --> A
    H[Migration Script] --> B
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–µ–π—Ç–∏–Ω–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `leaderboard`
2. **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ö–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç —Å–ª—É–∂–±a –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ —Ä–µ–π—Ç–∏–Ω–≥–∏
3. **Fallback**: –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫—ç—à–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ `users`
4. **–ò–Ω–¥–µ–∫—Å—ã**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–ª–ª–µ–∫—Ü–∏—è `leaderboard`

```javascript
{
  userId: String,           // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
  username: String,         // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è
  firstName: String,        // –ò–º—è
  lastName: String,         // –§–∞–º–∏–ª–∏—è
  nickname: String,         // –ù–∏–∫–Ω–µ–π–º
  score: Number,            // –û–±—â–∏–π —Å—á–µ—Ç
  rank: Number,             // –ü–æ–∑–∏—Ü–∏—è –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ
  userRank: String,         // –ó–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
  period: String,           // 'day', 'week', 'month', 'all'
  investigations: Number,   // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π
  accuracy: Number,         // –¢–æ—á–Ω–æ—Å—Ç—å –≤ %
  winStreak: Number,        // –¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è –ø–æ–±–µ–¥
  lastGameDate: Date,       // –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏–≥—Ä—ã
  updatedAt: Date          // –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞
}
```

### –ò–Ω–¥–µ–∫—Å—ã

```javascript
// –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞
{ period: 1, score: -1, rank: 1 }

// –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ
{ period: 1, userId: 1 }

// –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π
{ updatedAt: 1 }

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
{ userId: 1 }
{ period: 1 }
```

## üîß API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

#### `GET /api/leaderboard/:period`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `period`: `day` | `week` | `month` | `all`
- `limit`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20)

**–û—Ç–≤–µ—Ç:**
```javascript
{
  "status": "success",
  "data": {
    "leaderboard": [
      {
        "rank": 1,
        "isCurrentUser": false,
        "name": "–ò–≥—Ä–æ–∫123",
        "score": 1500,
        "userRank": "–î–ï–¢–ï–ö–¢–ò–í"
      }
    ],
    "currentUser": {
      "rank": 42,
      "isCurrentUser": true,
      "name": "–¢–µ–∫—É—â–∏–π –∏–≥—Ä–æ–∫",
      "score": 750,
      "userRank": "–ù–û–í–ò–ß–û–ö"
    },
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 20
    },
    "meta": {
      "period": "all",
      "cached": true,
      "fallback": false,
      "updatedAt": "2023-12-01T10:30:00Z"
    }
  }
}
```

#### `GET /api/leaderboard/status`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–ª—É–∂–±—ã —Ä–µ–π—Ç–∏–Ω–≥–æ–≤.

**–û—Ç–≤–µ—Ç:**
```javascript
{
  "status": "success",
  "data": {
    "isRunning": true,
    "isUpdating": false,
    "lastUpdateTime": "2023-12-01T10:30:00Z",
    "updateIntervalMs": 600000,
    "nextUpdateIn": 450000,
    "cacheStats": {
      "all": 156,
      "day": 45,
      "week": 89,
      "month": 134
    }
  }
}
```

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

#### `POST /api/leaderboard/force-update`
–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```javascript
{
  "period": "all"  // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
}
```

#### `DELETE /api/leaderboard/cache`
–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `period`: –ø–µ—Ä–∏–æ–¥ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### `GET /api/leaderboard/user/:userId`
–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ –≤—Å–µ—Ö —Ä–µ–π—Ç–∏–Ω–≥–∞—Ö.

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 1. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

```bash
# –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
npm run migrate-leaderboard
```

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫

–°–ª—É–∂–±–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```javascript
// –í src/index.js
leaderboardService.start();
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–ª—É–∂–±—ã:

```bash
curl GET /api/leaderboard/status
```

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –û–ø–µ—Ä–∞—Ü–∏—è | –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ | –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|----------------|---------------|-----------|
| –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ø-20 | ~50ms | ~5ms | **10x** |
| –ü–æ–∏—Å–∫ –ø–æ–∑–∏—Ü–∏–∏ –∏–≥—Ä–æ–∫–∞ | ~100ms | ~2ms | **50x** |
| –†–µ–π—Ç–∏–Ω–≥ –∑–∞ –ø–µ—Ä–∏–æ–¥ | ~200ms | ~5ms | **40x** |

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã**: –£—Å–∫–æ—Ä—è—é—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ—Ä—è–¥–∫–∏
2. **Lean queries**: –≠–∫–æ–Ω–æ–º—è—Ç –ø–∞–º—è—Ç—å –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö
3. **Batch operations**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Å–æ–≤—ã–µ –≤—Å—Ç–∞–≤–∫–∏
4. **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –°–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üîÑ –°–ª—É–∂–±–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### LeaderboardService

–ö–ª–∞—Å—Å-—Å–∏–Ω–≥–ª—Ç–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Ä–µ–π—Ç–∏–Ω–≥–æ–≤.

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

```javascript
// –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã
leaderboardService.start();

// –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª—É–∂–±—ã
leaderboardService.stop();

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
await leaderboardService.updateLeaderboards();

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ —Å fallback
const result = await leaderboardService.getLeaderboard('all', 20, userId);

// –°—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã
const status = leaderboardService.getStatus();
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- **–ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 10 –º–∏–Ω—É—Ç (600,000 –º—Å)
- **–ê–≤—Ç–æ—Å—Ç–∞—Ä—Ç**: –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ MongoDB
- **Graceful shutdown**: –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ SIGTERM/SIGINT

## üìã Periods (–ü–µ—Ä–∏–æ–¥—ã)

### –¢–∏–ø—ã –ø–µ—Ä–∏–æ–¥–æ–≤

1. **`all`** - –í—Å–µ –≤—Ä–µ–º—è
   - –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –¥–∞—Ç–µ

2. **`month`** - –ü–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å `lastVisit >= (now - 30 –¥–Ω–µ–π)`

3. **`week`** - –ü–æ—Å–ª–µ–¥–Ω—è—è –Ω–µ–¥–µ–ª—è
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å `lastVisit >= (now - 7 –¥–Ω–µ–π)`

4. **`day`** - –ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å `lastVisit >= (now - 1 –¥–µ–Ω—å)`

### –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

```javascript
const getDateFilter = (period) => {
  const now = new Date();
  switch (period) {
    case 'day':
      return { lastVisit: { $gte: new Date(now - 24*60*60*1000) } };
    case 'week':
      return { lastVisit: { $gte: new Date(now - 7*24*60*60*1000) } };
    case 'month':
      return { lastVisit: { $gte: new Date(now - 30*24*60*60*1000) } };
    default:
      return {}; // all time
  }
};
```

## üõ†Ô∏è –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∑–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ä—à–µ 1 –¥–Ω—è:

```javascript
await Leaderboard.cleanupOldEntries();
```

### –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤

```javascript
const { createIndexes } = require('./src/utils/migrateLeaderboard');
await createIndexes();
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–º–µ—Ä–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

```bash
# –í MongoDB shell
db.leaderboard.stats()
db.leaderboard.count()
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —ç–º–æ–¥–∑–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞:

- üöÄ –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±
- üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚ùå –û—à–∏–±–∫–∏
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üßπ –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```javascript
// –°—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã
const status = leaderboardService.getStatus();
console.log('–°–ª—É–∂–±–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç:', status.isRunning);
console.log('–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:', status.lastUpdateTime);

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞
const stats = await Promise.all([
  Leaderboard.countDocuments({ period: 'all' }),
  Leaderboard.countDocuments({ period: 'week' }),
  Leaderboard.countDocuments({ period: 'month' }),
  Leaderboard.countDocuments({ period: 'day' })
]);
console.log('–ó–∞–ø–∏—Å–µ–π –≤ –∫—ç—à–µ:', stats);
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã middleware `authMiddleware`.

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–æ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

1. **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞** —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
2. **–ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π** –∫—ç—à–∞
3. **–†–∞–∑–º–µ—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–∏** leaderboard
4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤**

### Health check

```javascript
app.get('/api/health/leaderboard', async (req, res) => {
  const status = leaderboardService.getStatus();
  const isHealthy = status.isRunning && 
    (Date.now() - status.lastUpdateTime?.getTime()) < 15 * 60 * 1000; // 15 –º–∏–Ω—É—Ç
  
  res.status(isHealthy ? 200 : 503).json({
    healthy: isHealthy,
    status
  });
});
```

---

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

1. **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –µ—â–µ –±–æ–ª—å—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. **–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è** –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ WebSockets
3. **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∏** –ø–æ —Å—Ç—Ä–∞–Ω–∞–º/—Ä–µ–≥–∏–æ–Ω–∞–º
4. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏** –¥—Ä—É–∑–µ–π
5. **–ê/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è 