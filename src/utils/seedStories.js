const Story = require('../models/Story');

/**
 * Тестовые истории для заполнения базы данных
 */
const sampleStories = [
    {
        title: 'ОГРАБЛЕНИЕ ЮВЕЛИРНОГО МАГАЗИНА',
        content: 'Преступник взломал заднюю дверь ювелирного магазина в 3 часа ночи. Он отключил камеры видеонаблюдения, но не заметил скрытую камеру над сейфом. На записи видно, как он без перчаток открывает витрины и собирает украшения в рюкзак. Перед уходом преступник воспользовался раковиной в подсобке, чтобы смыть кровь с пореза на руке.',
        date: '12.04.2024',
        difficulty: 'medium',
        mistakes: [
            {
                id: 'mistake-1',
                text: 'Неправильно отключил систему видеонаблюдения, не заметив скрытую камеру',
                isCorrect: false,
                explanation: 'Хотя преступник допустил ошибку с камерой, это не является критической уликой. Многие современные камеры не фиксируют детали лица в темноте достаточно четко для идентификации.'
            },
            {
                id: 'mistake-2',
                text: 'Работал без перчаток, оставив отпечатки пальцев на витринах и украшениях',
                isCorrect: false,
                explanation: 'Отпечатки пальцев - серьезная улика, но современные преступники часто используют методы для их уничтожения или маскировки. Кроме того, для идентификации нужно, чтобы отпечатки преступника уже были в базе данных.'
            },
            {
                id: 'mistake-3',
                text: 'Оставил свои биологические следы, смыв кровь в раковине, что позволило получить его ДНК',
                isCorrect: true,
                explanation: 'Преступник оставил биологический материал (кровь), который попал в слив раковины. Даже после смывания, следы ДНК остаются на сантехнике и в трубах. Криминалисты легко извлекают такие образцы и используют для идентификации. Современные методы могут выделить ДНК-профиль даже из микроскопических следов крови.'
            }
        ]
    },
    {
        title: 'КРАЖА В МУЗЕЕ ИСКУССТВ',
        content: 'Во время выставки импрессионистов в городском музее была украдена картина Клода Моне. Преступник проник в здание во время рабочих часов, притворившись работником технической службы. В момент кражи он отключил сигнализацию на 5 минут, быстро срезал картину с рамы и спрятал её в специальный тубус для чертежей. На следующий день он разместил объявление о продаже редкого "принта Моне" на интернет-аукционе.',
        date: '23.05.2024',
        difficulty: 'hard',
        mistakes: [
            {
                id: 'mistake-1',
                text: 'Проникновение в рабочие часы - слишком много свидетелей могли его заметить',
                isCorrect: false,
                explanation: 'Хотя это рискованно, многие успешные кражи произведений искусства происходят именно в рабочее время. В толпе посетителей и сотрудников преступник может оставаться незамеченным, особенно в большом музее.'
            },
            {
                id: 'mistake-2',
                text: 'Продажа украденного через интернет-аукцион, что легко отслеживается правоохранительными органами',
                isCorrect: true,
                explanation: 'Попытка продать украденное произведение искусства через публичный интернет-аукцион - критическая ошибка. Правоохранительные органы регулярно мониторят онлайн-площадки на предмет похищенных ценностей. IP-адрес, данные аккаунта и платежная информация могут напрямую привести к преступнику.'
            },
            {
                id: 'mistake-3',
                text: 'Отключение сигнализации, которое фиксируется в журнале системы безопасности',
                isCorrect: false,
                explanation: 'Отключение сигнализации действительно фиксируется, но профессиональные воры часто используют методы, которые имитируют технический сбой или плановое обслуживание, что усложняет расследование.'
            }
        ]
    },
    {
        title: 'ОТРАВЛЕНИЕ В РЕСТОРАНЕ',
        content: 'В элитном ресторане "Золотой Лев" произошло отравление известного бизнесмена. На следующий день в полицию пришла анонимная записка с требованием выкупа. В ней говорилось, что был использован специальный токсин, и если семья жертвы не заплатит, отравитель расскажет прессе формулу, что вызовет панику. После анализа камер видеонаблюдения полиция увидела официантку, добавившую что-то в блюдо. При обыске ее квартиры были найдены химические реактивы, а на ноутбуке - открытые вкладки с информацией о быстродействующих ядах.',
        date: '05.06.2024',
        difficulty: 'easy',
        mistakes: [
            {
                id: 'mistake-1',
                text: 'Отправка анонимной записки с требованием выкупа, что указывает на финансовый мотив',
                isCorrect: false,
                explanation: 'Это действительно ошибка, но не самая серьезная. Анонимные записки могут содержать ложную информацию, и вымогательство после преступления - распространенная практика даже среди непричастных лиц.'
            },
            {
                id: 'mistake-2',
                text: 'Совершение преступления в ресторане с камерами наблюдения, которые зафиксировали её действия',
                isCorrect: true,
                explanation: 'Добавление яда в блюдо под прямым наблюдением камер - критическая ошибка. Системы видеонаблюдения в ресторанах высокого класса обычно имеют хорошее разрешение и охватывают кухню и зал. Прямая видеозапись преступления является неопровержимым доказательством в суде.'
            },
            {
                id: 'mistake-3',
                text: 'Хранение химических реактивов и информации о ядах на личном ноутбуке',
                isCorrect: false,
                explanation: 'Хотя это подозрительно, но не является прямым доказательством преступления. Многие люди интересуются химией или изучают токсикологию по разным причинам. Без доказательства использования конкретных веществ для отравления, эти улики являются косвенными.'
            }
        ]
    },
    {
        title: 'УГОН АВТОМОБИЛЯ',
        content: 'В престижном районе города был угнан дорогой спортивный автомобиль. Преступник действовал глубокой ночью, взломав электронную систему безопасности с помощью специального устройства. На парковке, где стоял автомобиль, ему удалось избежать попадания в зону видеокамер. Через несколько дней полиция обнаружила автомобиль в заброшенном гараже на окраине города. Из машины были сняты номера и некоторые детали. При осмотре места преступник оставил на руле и кресле автомобиля множество волокон от своей одежды и несколько шоколадных фантиков с отпечатками пальцев.',
        date: '18.04.2024',
        difficulty: 'medium',
        mistakes: [
            {
                id: 'mistake-1',
                text: 'Оставил автомобиль в заброшенном гараже недалеко от города, что облегчило его обнаружение',
                isCorrect: false,
                explanation: 'Хотя место хранения было неудачным, это не критическая ошибка. Многие угнанные автомобили обнаруживаются в подобных местах, и сам факт обнаружения машины не обязательно ведет к поимке преступника.'
            },
            {
                id: 'mistake-2',
                text: 'Не избавился от упаковок от еды, оставив на них свои отпечатки пальцев',
                isCorrect: true,
                explanation: 'Оставление отпечатков пальцев на предметах в угнанном автомобиле - критическая ошибка. Фантики от шоколада сохраняют отпечатки особенно хорошо благодаря жирной поверхности. Если отпечатки есть в базе данных полиции, это прямое доказательство присутствия конкретного человека в автомобиле.'
            },
            {
                id: 'mistake-3',
                text: 'Оставил волокна от своей одежды на руле и сиденье',
                isCorrect: false,
                explanation: 'Волокна одежды сложно связать с конкретным человеком без образца для сравнения. Текстильные волокна обычно являются распространенными материалами, и анализ может показать только тип ткани, но не конкретный предмет одежды или его владельца без дополнительных улик.'
            }
        ]
    },
    {
        title: 'ВЗЛОМ БАНКОМАТА',
        content: 'Ночью в малолюдном районе был взломан банкомат. Преступник использовал газовую горелку для вскрытия депозитного отсека, избегая электронного взлома. Он работал в маске и перчатках, однако во время операции случайно обронил квитанцию из супермаркета, где он расплачивался картой. Также он не заметил, что на его ботинках был строительный раствор, и оставил четкие следы на полу возле банкомата. После завершения он поспешно скрылся на своем автомобиле, случайно попав под камеру дорожного движения на ближайшем перекрестке.',
        date: '29.05.2024',
        difficulty: 'hard',
        mistakes: [
            {
                id: 'mistake-1',
                text: 'Оставил следы обуви со строительным раствором на месте преступления',
                isCorrect: false,
                explanation: 'Следы обуви могут указать на тип обуви, но без сравнительного образца конкретной пары ботинок, они не являются критическим доказательством. Строительный раствор - распространенный материал, который не может быть надежно связан с конкретным человеком или местом.'
            },
            {
                id: 'mistake-2',
                text: 'Обронил квитанцию из супермаркета с данными своей банковской карты',
                isCorrect: true,
                explanation: 'Квитанция с информацией о банковской карте - критическая ошибка. На чеке может быть указана часть номера карты, время и место покупки. Это позволяет следователям запросить видеозаписи из магазина за конкретное время и идентифицировать преступника, а также получить данные о владельце карты у банка.'
            },
            {
                id: 'mistake-3',
                text: 'Использовал свой автомобиль и попал на камеры дорожного наблюдения',
                isCorrect: false,
                explanation: 'Хотя попадание на камеры дорожного движения рискованно, это не обязательно критическая ошибка. Если номера не видны четко или автомобиль не зарегистрирован на преступника, одно только присутствие машины в районе не является достаточным доказательством причастности к преступлению.'
            }
        ]
    }
];

/**
 * Заполнение базы данных тестовыми историями
 */
const seedStories = async () => {
    try {
        // Проверяем, есть ли уже истории в базе
        const count = await Story.countDocuments();

        if (count === 0) {
            
            // Преобразуем истории, чтобы добавить уникальные идентификаторы
            const storiesWithIds = sampleStories.map((story, index) => ({
                ...story,
                id: `story-${index + 1}`,
                createdAt: new Date()
            }));

            // Вставляем тестовые истории
            await Story.insertMany(storiesWithIds);

        } else {
            
        }
    } catch (error) {
        console.error('Ошибка при заполнении базы данных историями:', error);
    }
};

module.exports = seedStories; 