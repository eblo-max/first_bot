/**
 * –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "–ö—Ä–∏–º–∏–Ω–∞–ª—å–Ω—ã–π –ë–ª–µ—Ñ"
 * –°–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫—É –∏–≥—Ä—ã, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å API –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
 */

// –û–±—ä–µ–∫—Ç Telegram WebApp –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ API Telegram Mini Apps
let tg = null;

// –î–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
const GameData = {
    score: 0,
    gameId: null,
    currentStory: null,
    currentStoryIndex: 0,
    stories: [],
    secondsLeft: 15,
    timerDuration: 15,
    timer: null,
    startTime: null,
    result: null,
    gameResult: null,
    isAnswering: false,
    answerSelected: false,
    token: null,
    theme: 'dark',
    isTestMode: false
};

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º GameData –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏
window.GameData = GameData;

/**
 * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
 */
function initApp() {
    console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞—á–∞—Ç–∞...');

    try {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Telegram WebApp API
        if (!window.Telegram || !window.Telegram.WebApp) {
            console.warn('Telegram WebApp API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–ø—É—Å–∫ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ');
            handleNoTelegramApi();
            return;
        }

        // –ü–æ–ª—É—á–∞–µ–º –æ–±—ä–µ–∫—Ç Telegram WebApp
        tg = window.Telegram.WebApp;
        console.log('Telegram WebApp API –Ω–∞–π–¥–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...');

        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É Telegram
        const theme = tg.colorScheme || 'dark';
        GameData.theme = theme;
        document.body.setAttribute('data-theme', theme);
        console.log('–ü—Ä–∏–º–µ–Ω–µ–Ω–∞ —Ç–µ–º–∞:', theme);

        // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
        tg.expand();

        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
        tg.BackButton.onClick(() => handleBackButton());

        // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ GameInterface –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
        if (typeof GameInterface === 'undefined') {
            console.warn('GameInterface –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –æ–∂–∏–¥–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É DOM');
            document.addEventListener('DOMContentLoaded', () => {
                console.log('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∑–∞–ø—É—Å–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö...');
                loadGameData();
            });
        } else {
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
            console.log('GameInterface —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∑–∞–ø—É—Å–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö...');
            loadGameData();
        }

    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', error);
        handleNoTelegramApi();
    }
}

/**
 * –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è Telegram WebApp API
 */
function handleNoTelegramApi() {
    console.warn('–ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - Telegram WebApp API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
    GameData.isTestMode = true;

    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞–≥–ª—É—à–∫—É –¥–ª—è Telegram WebApp API –µ—Å–ª–∏ –µ—ë –µ—â—ë –Ω–µ—Ç
    if (!window.Telegram) {
        window.Telegram = {
            WebApp: {
                ready: () => { console.log('WebApp.ready() –≤—ã–∑–≤–∞–Ω –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è'); },
                expand: () => { console.log('WebApp.expand() –≤—ã–∑–≤–∞–Ω –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è'); },
                initData: "test_mode_data",
                initDataUnsafe: {
                    user: {
                        id: 12345678,
                        first_name: "Test",
                        last_name: "User",
                        username: "testuser"
                    }
                },
                BackButton: {
                    show: () => { console.log('BackButton.show() –≤—ã–∑–≤–∞–Ω –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è'); },
                    hide: () => { console.log('BackButton.hide() –≤—ã–∑–≤–∞–Ω –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è'); },
                    onClick: (callback) => { console.log('BackButton.onClick() —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è'); }
                },
                colorScheme: "dark",
                HapticFeedback: {
                    impactOccurred: () => { console.log('HapticFeedback.impactOccurred –≤—ã–∑–≤–∞–Ω –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è'); },
                    notificationOccurred: () => { console.log('HapticFeedback.notificationOccurred –≤—ã–∑–≤–∞–Ω –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è'); }
                }
            }
        };
    }

    tg = window.Telegram.WebApp;
    loadGameData(true);
}

/**
 * –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥ Telegram
 */
function handleBackButton() {
    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–µ—Ä–≤–∞—Ç—å –∏–≥—Ä—É?')) {
        window.location.href = '/';
    }
}

/**
 * –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–≥—Ä—ã
 * @param {boolean} testMode - –§–ª–∞–≥ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
 */
async function loadGameData(testMode = false) {
    console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–≥—Ä—ã...');

    try {
        if (testMode || GameData.isTestMode) {
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...');
            loadTestData();
            return;
        }

        // –ó–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        // –ù–æ –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –±—ç–∫–µ–Ω–¥–æ–º,
        // –ø–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        loadTestData();

    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
        alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö. –ò–≥—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.');
        loadTestData();
    }
}

/**
 * –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–≥—Ä—ã
 */
function loadTestData() {
    console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–≥—Ä—ã');

    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –∏–≥—Ä—ã
    const testStories = [
        {
            id: 'test-story-1',
            title: '–û–ì–†–ê–ë–õ–ï–ù–ò–ï –Æ–í–ï–õ–ò–†–ù–û–ì–û –ú–ê–ì–ê–ó–ò–ù–ê',
            content: '–ü—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ –≤–∑–ª–æ–º–∞–ª –∑–∞–¥–Ω—é—é –¥–≤–µ—Ä—å —é–≤–µ–ª–∏—Ä–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ –≤ 3 —á–∞—Å–∞ –Ω–æ—á–∏. –û–Ω –æ—Ç–∫–ª—é—á–∏–ª –∫–∞–º–µ—Ä—ã –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –Ω–æ –Ω–µ –∑–∞–º–µ—Ç–∏–ª <span class="highlighted-text">—Å–∫—Ä—ã—Ç—É—é –∫–∞–º–µ—Ä—É –Ω–∞–¥ —Å–µ–π—Ñ–æ–º</span>. –ù–∞ –∑–∞–ø–∏—Å–∏ –≤–∏–¥–Ω–æ, –∫–∞–∫ –æ–Ω <span class="highlighted-text">–±–µ–∑ –ø–µ—Ä—á–∞—Ç–æ–∫</span> –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–∏—Ç—Ä–∏–Ω—ã –∏ —Å–æ–±–∏—Ä–∞–µ—Ç —É–∫—Ä–∞—à–µ–Ω–∏—è –≤ —Ä—é–∫–∑–∞–∫. –ü–µ—Ä–µ–¥ —É—Ö–æ–¥–æ–º –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è <span class="highlighted-text">—Ä–∞–∫–æ–≤–∏–Ω–æ–π –≤ –ø–æ–¥—Å–æ–±–∫–µ</span>, —á—Ç–æ–±—ã —Å–º—ã—Ç—å –∫—Ä–æ–≤—å —Å –ø–æ—Ä–µ–∑–∞ –Ω–∞ —Ä—É–∫–µ.',
            date: '12.04.2024',
            difficulty: 'medium',
            mistakes: [
                {
                    id: 'mistake-1',
                    text: '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–∏–ª —Å–∏—Å—Ç–µ–º—É –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –Ω–µ –∑–∞–º–µ—Ç–∏–≤ —Å–∫—Ä—ã—Ç—É—é –∫–∞–º–µ—Ä—É',
                    isCorrect: false,
                    explanation: '–•–æ—Ç—è –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ –¥–æ–ø—É—Å—Ç–∏–ª –æ—à–∏–±–∫—É —Å –∫–∞–º–µ—Ä–æ–π, —ç—Ç–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —É–ª–∏–∫–æ–π. –ú–Ω–æ–≥–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞–º–µ—Ä—ã –Ω–µ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –¥–µ—Ç–∞–ª–∏ –ª–∏—Ü–∞ –≤ —Ç–µ–º–Ω–æ—Ç–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–µ—Ç–∫–æ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.'
                },
                {
                    id: 'mistake-2',
                    text: '–†–∞–±–æ—Ç–∞–ª –±–µ–∑ –ø–µ—Ä—á–∞—Ç–æ–∫, –æ—Å—Ç–∞–≤–∏–≤ –æ—Ç–ø–µ—á–∞—Ç–∫–∏ –ø–∞–ª—å—Ü–µ–≤ –Ω–∞ –≤–∏—Ç—Ä–∏–Ω–∞—Ö –∏ —É–∫—Ä–∞—à–µ–Ω–∏—è—Ö',
                    isCorrect: false,
                    explanation: '–û—Ç–ø–µ—á–∞—Ç–∫–∏ –ø–∞–ª—å—Ü–µ–≤ - —Å–µ—Ä—å–µ–∑–Ω–∞—è —É–ª–∏–∫–∞, –Ω–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –∏—Ö —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è –∏–ª–∏ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –æ—Ç–ø–µ—á–∞—Ç–∫–∏ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–∞ —É–∂–µ –±—ã–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.'
                },
                {
                    id: 'mistake-3',
                    text: '–û—Å—Ç–∞–≤–∏–ª —Å–≤–æ–∏ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Å–ª–µ–¥—ã, —Å–º—ã–≤ –∫—Ä–æ–≤—å –≤ —Ä–∞–∫–æ–≤–∏–Ω–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ –î–ù–ö',
                    isCorrect: true,
                    explanation: '–ü—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ –æ—Å—Ç–∞–≤–∏–ª –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª (–∫—Ä–æ–≤—å), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ø–∞–ª –≤ —Å–ª–∏–≤ —Ä–∞–∫–æ–≤–∏–Ω—ã. –î–∞–∂–µ –ø–æ—Å–ª–µ —Å–º—ã–≤–∞–Ω–∏—è, —Å–ª–µ–¥—ã –î–ù–ö –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–µ –∏ –≤ —Ç—Ä—É–±–∞—Ö. –ö—Ä–∏–º–∏–Ω–∞–ª–∏—Å—Ç—ã –ª–µ–≥–∫–æ –∏–∑–≤–ª–µ–∫–∞—é—Ç —Ç–∞–∫–∏–µ –æ–±—Ä–∞–∑—Ü—ã –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –≤—ã–¥–µ–ª–∏—Ç—å –î–ù–ö-–ø—Ä–æ—Ñ–∏–ª—å –¥–∞–∂–µ –∏–∑ –º–∏–∫—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–∏—Ö —Å–ª–µ–¥–æ–≤ –∫—Ä–æ–≤–∏.'
                }
            ]
        },
        {
            id: 'test-story-2',
            title: '–ö–†–ê–ñ–ê –í –ú–£–ó–ï–ï –ò–°–ö–£–°–°–¢–í',
            content: '–í–æ –≤—Ä–µ–º—è –≤—ã—Å—Ç–∞–≤–∫–∏ –∏–º–ø—Ä–µ—Å—Å–∏–æ–Ω–∏—Å—Ç–æ–≤ –≤ –≥–æ—Ä–æ–¥—Å–∫–æ–º –º—É–∑–µ–µ –±—ã–ª–∞ —É–∫—Ä–∞–¥–µ–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∞ –ö–ª–æ–¥–∞ –ú–æ–Ω–µ. –ü—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ –ø—Ä–æ–Ω–∏–∫ –≤ –∑–¥–∞–Ω–∏–µ <span class="highlighted-text">–≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤</span>, –ø—Ä–∏—Ç–≤–æ—Ä–∏–≤—à–∏—Å—å —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Å–ª—É–∂–±—ã. –í –º–æ–º–µ–Ω—Ç –∫—Ä–∞–∂–∏ –æ–Ω <span class="highlighted-text">–æ—Ç–∫–ª—é—á–∏–ª —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—é</span> –Ω–∞ 5 –º–∏–Ω—É—Ç, –±—ã—Å—Ç—Ä–æ —Å—Ä–µ–∑–∞–ª –∫–∞—Ä—Ç–∏–Ω—É —Å —Ä–∞–º—ã –∏ —Å–ø—Ä—è—Ç–∞–ª –µ—ë –≤ <span class="highlighted-text">—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç—É–±—É—Å –¥–ª—è —á–µ—Ä—Ç–µ–∂–µ–π</span>. –ù–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –æ–Ω —Ä–∞–∑–º–µ—Å—Ç–∏–ª –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–¥–∞–∂–µ —Ä–µ–¥–∫–æ–≥–æ "–ø—Ä–∏–Ω—Ç–∞ –ú–æ–Ω–µ" –Ω–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–∞—É–∫—Ü–∏–æ–Ω–µ.',
            date: '23.05.2024',
            difficulty: 'hard',
            mistakes: [
                {
                    id: 'mistake-1',
                    text: '–ü—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ –≤ —Ä–∞–±–æ—á–∏–µ —á–∞—Å—ã - —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–≤–∏–¥–µ—Ç–µ–ª–µ–π –º–æ–≥–ª–∏ –µ–≥–æ –∑–∞–º–µ—Ç–∏—Ç—å',
                    isCorrect: false,
                    explanation: '–•–æ—Ç—è —ç—Ç–æ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ, –º–Ω–æ–≥–∏–µ —É—Å–ø–µ—à–Ω—ã–µ –∫—Ä–∞–∂–∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∏–º–µ–Ω–Ω–æ –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è. –í —Ç–æ–ª–ø–µ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ –º–æ–∂–µ—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ–∑–∞–º–µ—á–µ–Ω–Ω—ã–º, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –±–æ–ª—å—à–æ–º –º—É–∑–µ–µ.'
                },
                {
                    id: 'mistake-2',
                    text: '–ü—Ä–æ–¥–∞–∂–∞ —É–∫—Ä–∞–¥–µ–Ω–Ω–æ–≥–æ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–∞—É–∫—Ü–∏–æ–Ω, —á—Ç–æ –ª–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ—Ä–≥–∞–Ω–∞–º–∏',
                    isCorrect: true,
                    explanation: '–ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–æ–¥–∞—Ç—å —É–∫—Ä–∞–¥–µ–Ω–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏—Å–∫—É—Å—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–∞—É–∫—Ü–∏–æ–Ω - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞. –ü—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ä–≥–∞–Ω—ã —Ä–µ–≥—É–ª—è—Ä–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä—è—Ç –æ–Ω–ª–∞–π–Ω-–ø–ª–æ—â–∞–¥–∫–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø–æ—Ö–∏—â–µ–Ω–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π. IP-–∞–¥—Ä–µ—Å, –¥–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ –ø–ª–∞—Ç–µ–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–≥—É—Ç –Ω–∞–ø—Ä—è–º—É—é –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫—É.'
                },
                {
                    id: 'mistake-3',
                    text: '–û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ –∂—É—Ä–Ω–∞–ª–µ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                    isCorrect: false,
                    explanation: '–û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ—Ä—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–∏—Ç–∏—Ä—É—é—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–±–æ–π –∏–ª–∏ –ø–ª–∞–Ω–æ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, —á—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ.'
                }
            ]
        },
        {
            id: 'test-story-3',
            title: '–ú–û–®–ï–ù–ù–ò–ß–ï–°–¢–í–û –°–û –°–¢–†–ê–•–û–í–ö–û–ô',
            content: '–ë–∏–∑–Ω–µ—Å–º–µ–Ω –∑–∞—è–≤–∏–ª –æ –∫—Ä–∞–∂–µ –¥–æ—Ä–æ–≥–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∏ –ø–æ–¥–∞–ª –∑–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞—Ö–æ–≤—É—é –≤—ã–ø–ª–∞—Ç—É –≤ —Ä–∞–∑–º–µ—Ä–µ 180 000 –µ–≤—Ä–æ. –ü–æ –µ–≥–æ —Å–ª–æ–≤–∞–º, –∞–≤—Ç–æ–º–æ–±–∏–ª—å –±—ã–ª —É–∫—Ä–∞–¥–µ–Ω —Å –ø–æ–¥–∑–µ–º–Ω–æ–π –ø–∞—Ä–∫–æ–≤–∫–∏ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞. –ü–æ–ª–∏—Ü–∏—è –Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏ –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞, —á—Ç–æ –≤–ª–∞–¥–µ–ª–µ—Ü <span class="highlighted-text">–Ω–µ–¥–∞–≤–Ω–æ –∏–º–µ–ª —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏</span> –∏ <span class="highlighted-text">—Å–Ω—è–ª —Å –º–∞—à–∏–Ω—ã –¥–æ—Ä–æ–≥–∏–µ –¥–µ—Ç–∞–ª–∏ –ø–µ—Ä–µ–¥ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–æ–π –∫—Ä–∞–∂–µ–π</span>. –¢–∞–∫–∂–µ –≤—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ –æ–Ω <span class="highlighted-text">—Å–º–µ–Ω–∏–ª —Å—Ç—Ä–∞—Ö–æ–≤—É—é –∫–æ–º–ø–∞–Ω–∏—é –∑–∞ –º–µ—Å—è—Ü –¥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞</span>, —É–≤–µ–ª–∏—á–∏–≤ —Å—Ç—Ä–∞—Ö–æ–≤—É—é —Å—É–º–º—É.',
            date: '07.02.2024',
            difficulty: 'easy',
            mistakes: [
                {
                    id: 'mistake-1',
                    text: '–°–º–µ–Ω–∞ —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ö–æ–≤–æ–π —Å—É–º–º—ã –Ω–µ–∑–∞–¥–æ–ª–≥–æ –¥–æ "–∫—Ä–∞–∂–∏"',
                    isCorrect: true,
                    explanation: '–°–º–µ–Ω–∞ —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –ø–æ–≤—ã—à–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ö–æ–≤–æ–π —Å—É–º–º—ã –Ω–µ–∑–∞–¥–æ–ª–≥–æ –¥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ - –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–∑–Ω–∞–∫ —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞. –°—Ç—Ä–∞—Ö–æ–≤—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ –ø–æ–º–µ—á–∞—é—Ç —Ç–∞–∫–∏–µ —Å–ª—É—á–∞–∏ –∫–∞–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –ø—Ä–æ–≤–æ–¥—è—Ç –æ—Å–æ–±–µ–Ω–Ω–æ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ. –≠—Ç–æ –ø–µ—Ä–≤–æ–µ, –Ω–∞ —á—Ç–æ –æ–±—Ä–∞—â–∞—é—Ç –≤–Ω–∏–º–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏.'
                },
                {
                    id: 'mistake-2',
                    text: '–°–Ω—è—Ç–∏–µ –¥–æ—Ä–æ–≥–∏—Ö –¥–µ—Ç–∞–ª–µ–π –ø–µ—Ä–µ–¥ –∏–Ω—Å—Ü–µ–Ω–∏—Ä–æ–≤–∫–æ–π –∫—Ä–∞–∂–∏',
                    isCorrect: false,
                    explanation: '–•–æ—Ç—è —ç—Ç–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ, –¥–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –¥–µ—Ç–∞–ª–∏ –±—ã–ª–∏ —Å–Ω—è—Ç—ã –∏–º–µ–Ω–Ω–æ –≤–ª–∞–¥–µ–ª—å—Ü–µ–º, –∞ –Ω–µ –Ω–∞—Å—Ç–æ—è—â–∏–º–∏ –≤–æ—Ä–∞–º–∏ –ø–æ—Å–ª–µ –∫—Ä–∞–∂–∏, –¥–æ–≤–æ–ª—å–Ω–æ —Å–ª–æ–∂–Ω–æ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤.'
                },
                {
                    id: 'mistake-3',
                    text: '–ù–∞–ª–∏—á–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ç—Ä—É–¥–Ω–æ—Å—Ç–µ–π –∫–∞–∫ –º–æ—Ç–∏–≤ –¥–ª—è –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞',
                    isCorrect: false,
                    explanation: '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞—é—Ç –º–æ—Ç–∏–≤, –Ω–æ —Å–∞–º–∏ –ø–æ —Å–µ–±–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞. –ú–Ω–æ–≥–∏–µ –ª—é–¥–∏ —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∂–µ—Ä—Ç–≤–∞–º–∏ –Ω–∞—Å—Ç–æ—è—â–∏—Ö –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–π.'
                }
            ]
        },
        {
            id: 'test-story-4',
            title: '–ò–°–ß–ï–ó–ù–û–í–ï–ù–ò–ï –í –ì–û–†–ê–•',
            content: '–û–ø—ã—Ç–Ω—ã–π –∞–ª—å–ø–∏–Ω–∏—Å—Ç –±—ã–ª –æ–±—ä—è–≤–ª–µ–Ω –ø—Ä–æ–ø–∞–≤—à–∏–º –±–µ–∑ –≤–µ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º—è –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –≤–æ—Å—Ö–æ–∂–¥–µ–Ω–∏—è. –°–ø–∞—Å–∞—Ç–µ–ª—å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∞—Å—å –¥–≤–µ –Ω–µ–¥–µ–ª–∏, –Ω–æ —Ç–µ–ª–æ —Ç–∞–∫ –∏ –Ω–µ –Ω–∞—à–ª–∏. –ß–µ—Ä–µ–∑ —Ç—Ä–∏ –º–µ—Å—è—Ü–∞ –æ–Ω –±—ã–ª <span class="highlighted-text">–∑–∞–º–µ—á–µ–Ω –∂–∏–≤—ã–º –≤ –¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞–Ω–µ</span> —Å –Ω–æ–≤—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏. –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤—ã—è–≤–∏–ª–æ, —á—Ç–æ –ø–µ—Ä–µ–¥ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ–º –æ–Ω <span class="highlighted-text">–æ—Ñ–æ—Ä–º–∏–ª —Å—Ç—Ä–∞—Ö–æ–≤–∫—É –∂–∏–∑–Ω–∏ –Ω–∞ 2 –º–∏–ª–ª–∏–æ–Ω–∞ –¥–æ–ª–ª–∞—Ä–æ–≤</span> –≤ –ø–æ–ª—å–∑—É –∂–µ–Ω—ã, –∞ —Ç–∞–∫–∂–µ <span class="highlighted-text">–∏–º–µ–ª –∫—Ä—É–ø–Ω—ã–µ –¥–æ–ª–≥–∏</span> –ø–µ—Ä–µ–¥ –∫—Ä–∏–º–∏–Ω–∞–ª—å–Ω—ã–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏.',
            date: '14.11.2023',
            difficulty: 'medium',
            mistakes: [
                {
                    id: 'mistake-1',
                    text: '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫—Ä—É–ø–Ω–æ–π —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –∂–∏–∑–Ω–∏ –Ω–µ–∑–∞–¥–æ–ª–≥–æ –¥–æ –∏–Ω—Å—Ü–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å–º–µ—Ä—Ç–∏',
                    isCorrect: true,
                    explanation: '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫—Ä—É–ø–Ω–æ–π —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –∂–∏–∑–Ω–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥ "–Ω–µ—Å—á–∞—Å—Ç–Ω—ã–º —Å–ª—É—á–∞–µ–º" - —è–≤–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞. –°—Ç—Ä–∞—Ö–æ–≤—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç, –∫–∞–∫ –¥–∞–≤–Ω–æ –±—ã–ª –æ—Ñ–æ—Ä–º–ª–µ–Ω –ø–æ–ª–∏—Å –≤ —Å–ª—É—á–∞—è—Ö —Å –∫—Ä—É–ø–Ω—ã–º–∏ –≤—ã–ø–ª–∞—Ç–∞–º–∏, –∏ —á–∞—Å—Ç–æ –∑–∞–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤—ã–ø–ª–∞—Ç—ã –¥–æ –ø–æ–ª–Ω–æ–≥–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –≤ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö.'
                },
                {
                    id: 'mistake-2',
                    text: '–ù–∞–ª–∏—á–∏–µ –∫—Ä—É–ø–Ω—ã—Ö –¥–æ–ª–≥–æ–≤ –∫–∞–∫ –º–æ—Ç–∏–≤ –¥–ª—è –∏–Ω—Å—Ü–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å–º–µ—Ä—Ç–∏',
                    isCorrect: false,
                    explanation: '–î–æ–ª–≥–∏ —Å–æ–∑–¥–∞—é—Ç –º–æ—Ç–∏–≤, –Ω–æ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –æ—à–∏–±–∫–æ–π –≤ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞. –ö —Ç–æ–º—É –∂–µ, –Ω–∞—Å—Ç–æ—è—â–∏–µ –Ω–µ—Å—á–∞—Å—Ç–Ω—ã–µ —Å–ª—É—á–∞–∏ —Ç–∞–∫–∂–µ —Å–ª—É—á–∞—é—Ç—Å—è —Å –ª—é–¥—å–º–∏, –∏–º–µ—é—â–∏–º–∏ –¥–æ–ª–≥–∏.'
                },
                {
                    id: 'mistake-3',
                    text: '–ü–æ—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø—É–±–ª–∏–∫–µ –ø–æ–¥ –Ω–æ–≤—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ –ø–æ—Å–ª–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è',
                    isCorrect: false,
                    explanation: '–•–æ—Ç—è –ø–æ—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø—É–±–ª–∏–∫–µ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ, –º–Ω–æ–≥–∏–µ –ª—é–¥–∏ —É—Å–ø–µ—à–Ω–æ –Ω–∞—á–∏–Ω–∞—é—Ç –Ω–æ–≤—É—é –∂–∏–∑–Ω—å –ø–æ–¥ –Ω–æ–≤—ã–º–∏ –∏–º–µ–Ω–∞–º–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Å—Ç—Ä–∞–Ω–∞—Ö —Å –º–µ–Ω–µ–µ —Å—Ç—Ä–æ–≥–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º. –ì–ª–∞–≤–Ω–∞—è –æ—à–∏–±–∫–∞ –±—ã–ª–∞ –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å—Ö–µ–º–µ, –∞ –Ω–µ –≤ —ç—Ç–æ–º –∞—Å–ø–µ–∫—Ç–µ.'
                }
            ]
        },
        {
            id: 'test-story-5',
            title: '–û–¢–†–ê–í–õ–ï–ù–ò–ï –ë–ò–ó–ù–ï–°–ú–ï–ù–ê',
            content: '–ò–∑–≤–µ—Å—Ç–Ω—ã–π –±–∏–∑–Ω–µ—Å–º–µ–Ω –±—ã–ª –Ω–∞–π–¥–µ–Ω –º–µ—Ä—Ç–≤—ã–º –≤ —Å–≤–æ–µ–º –¥–æ–º–µ. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–∏—á–∏–Ω–æ–π —Å–º–µ—Ä—Ç–∏ —Å—á–∏—Ç–∞–ª—Å—è —Å–µ—Ä–¥–µ—á–Ω—ã–π –ø—Ä–∏—Å—Ç—É–ø, –Ω–æ —Ç–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –≤—ã—è–≤–∏–ª–∞ <span class="highlighted-text">—Ä–µ–¥–∫–∏–π —è–¥ —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è</span>. –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ–¥–æ–∑—Ä–µ–≤–∞–µ–º–æ–π —Å—Ç–∞–ª–∞ –µ–≥–æ –≤—Ç–æ—Ä–∞—è –∂–µ–Ω–∞, –∫–æ—Ç–æ—Ä–∞—è <span class="highlighted-text">–Ω–∞—Å—Ç–∞–∏–≤–∞–ª–∞ –Ω–∞ –∫—Ä–µ–º–∞—Ü–∏–∏</span> –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—Å–∫—Ä—ã—Ç–∏—è –∏ —è–≤–ª—è–ª–∞—Å—å <span class="highlighted-text">–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –Ω–∞—Å–ª–µ–¥–Ω–∏—Ü–µ–π</span> –ø–æ –Ω–µ–¥–∞–≤–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–º—É –∑–∞–≤–µ—â–∞–Ω–∏—é. –í –µ–µ –ø–æ–∏—Å–∫–æ–≤–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞—à–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –æ –º–µ—Ç–æ–¥–∞—Ö –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏—è.',
            date: '30.03.2024',
            difficulty: 'hard',
            mistakes: [
                {
                    id: 'mistake-1',
                    text: '–ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—Ç—Ä–∞–≤–ª—è—é—â–∏—Ö –≤–µ—â–µ—Å—Ç–≤–∞—Ö –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤',
                    isCorrect: true,
                    explanation: '–ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—Ç—Ä–∞–≤–ª—è—é—â–∏—Ö –≤–µ—â–µ—Å—Ç–≤–∞—Ö —Å –ª–∏—á–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞. –¶–∏—Ñ—Ä–æ–≤—ã–µ —Å–ª–µ–¥—ã –∫—Ä–∞–π–Ω–µ —Å–ª–æ–∂–Ω–æ —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é, –∏ –ø—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ä–≥–∞–Ω—ã –∏–º–µ—é—Ç –∑–∞–∫–æ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –ú–Ω–æ–≥–∏–µ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–∏ –±—ã–ª–∏ –ø–æ–π–º–∞–Ω—ã –∏–º–µ–Ω–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è –∏—Ö –æ–Ω–ª–∞–π–Ω-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ–º.'
                },
                {
                    id: 'mistake-2',
                    text: '–ù–∞—Å—Ç–∞–∏–≤–∞–Ω–∏–µ –Ω–∞ –∫—Ä–µ–º–∞—Ü–∏–∏ –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—Å–∫—Ä—ã—Ç–∏—è, —á—Ç–æ –≤—ã–∑–≤–∞–ª–æ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏—è',
                    isCorrect: false,
                    explanation: '–•–æ—Ç—è —ç—Ç–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ, –º–Ω–æ–≥–∏–µ –ª—é–¥–∏ –Ω–∞—Å—Ç–∞–∏–≤–∞—é—Ç –Ω–∞ –∫—Ä–µ–º–∞—Ü–∏–∏ –ø–æ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–º –∏–ª–∏ –ª–∏—á–Ω—ã–º —É–±–µ–∂–¥–µ–Ω–∏—è–º. –ö —Ç–æ–º—É –∂–µ, —Å–∞–º–æ –ø–æ —Å–µ–±–µ —ç—Ç–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ–º –∏–ª–∏ –ø—Ä—è–º—ã–º –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º.'
                },
                {
                    id: 'mistake-3',
                    text: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–¥–∫–æ–≥–æ —è–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –ø—Ä–∏ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–π —Ç–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–µ',
                    isCorrect: false,
                    explanation: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–¥–∞ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ, –Ω–æ –º–Ω–æ–≥–∏–µ –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ–∑–∞–º–µ—á–µ–Ω–Ω—ã–º–∏. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –±—ã–ª–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –∏–∑-–∑–∞ –¥—Ä—É–≥–∏—Ö –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤. –ì–ª–∞–≤–Ω–∞—è –æ—à–∏–±–∫–∞ –±—ã–ª–∞ –≤ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Å–ª–µ–¥–∞—Ö, –∞ –Ω–µ –≤ –≤—ã–±–æ—Ä–µ –º–µ—Ç–æ–¥–∞.'
                }
            ]
        }
    ];

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã
    GameData.gameId = 'test-game-' + Date.now();
    GameData.stories = testStories;
    GameData.currentStoryIndex = 0;
    GameData.currentStory = testStories[0];
    GameData.isTestMode = true;

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Ñ–ª–∞–≥–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
    GameData.isAnswering = false;
    GameData.answerSelected = false;
    GameData.result = null;

    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–∞–π–º–µ—Ä, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    if (GameData.timer) {
        clearInterval(GameData.timer);
        GameData.timer = null;
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    if (typeof GameInterface !== 'undefined') {
        GameInterface.updateUI(GameData);
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
    // (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ nextQuestion)
    setTimeout(() => {
        startTimer();
    }, 100);
}

/**
 * –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
 */
function startTimer() {
    console.log('–ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞...');

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
    clearInterval(GameData.timer);
    GameData.secondsLeft = GameData.timerDuration;
    GameData.startTime = Date.now();
    GameData.isAnswering = false;
    GameData.answerSelected = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–æ–≤–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞

    // –í—ã–∑—ã–≤–∞–µ–º —è–≤–Ω—ã–π —Å–±—Ä–æ—Å –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    if (typeof GameInterface !== 'undefined' && typeof GameInterface.resetTimer === 'function') {
        GameInterface.resetTimer(GameData.timerDuration);
    } else {
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º, –µ—Å–ª–∏ resetTimer –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω
        if (typeof GameInterface !== 'undefined') {
            GameInterface.updateTimer(GameData.secondsLeft, GameData.timerDuration);
        }
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
    GameData.timer = setInterval(() => {
        GameData.secondsLeft--;

        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
        if (typeof GameInterface !== 'undefined') {
            GameInterface.updateTimer(GameData.secondsLeft, GameData.timerDuration);
        }

        // –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø—Ä–∏ –º–∞–ª–æ–º –≤—Ä–µ–º–µ–Ω–∏
        if (GameData.secondsLeft <= 5 && tg && tg.HapticFeedback) {
            tg.HapticFeedback.notificationOccurred('warning');
        }

        // –í—Ä–µ–º—è –∏—Å—Ç–µ–∫–ª–æ
        if (GameData.secondsLeft <= 0) {
            timeExpired();
        }
    }, 1000);
}

/**
 * –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
 */
function timeExpired() {
    console.log('–í—Ä–µ–º—è –Ω–∞ –æ—Ç–≤–µ—Ç –∏—Å—Ç–µ–∫–ª–æ');

    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
    if (GameData.timer) {
        clearInterval(GameData.timer);
        GameData.timer = null;
        console.log('–¢–∞–π–º–µ—Ä —É—Å–ø–µ—à–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏');
    } else {
        console.warn('–¢–∞–π–º–µ—Ä –Ω–µ –±—ã–ª –Ω–∞–π–¥–µ–Ω –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ timeExpired');
    }

    // –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç —É–∂–µ –±—ã–ª –≤—ã–±—Ä–∞–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
    if (GameData.answerSelected) {
        console.log('–ü—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏, —Ç–∞–∫ –∫–∞–∫ –æ—Ç–≤–µ—Ç —É–∂–µ –≤—ã–±—Ä–∞–Ω');
        return;
    }

    // –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏ —Ç–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
    if (tg && tg.HapticFeedback) {
        tg.HapticFeedback.notificationOccurred('error');
    }

    // –ï—Å–ª–∏ –Ω–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–±–æ—Ä–∞ –æ—Ç–≤–µ—Ç–∞
    if (!GameData.isAnswering) {
        GameData.isAnswering = true;

        // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
        if (typeof GameInterface !== 'undefined' && typeof GameInterface.disableAnswerOptions === 'function') {
            GameInterface.disableAnswerOptions();
        }

        // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
        const correctMistake = GameData.currentStory.mistakes.find(m => m.isCorrect);

        // ========== –°–û–•–†–ê–ù–Ø–ï–ú –†–ï–ó–£–õ–¨–¢–ê–¢ –ü–†–ò –ò–°–¢–ï–ß–ï–ù–ò–ò –í–†–ï–ú–ï–ù–ò ==========
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–≤–µ—Ç–∞ –≤ —Ç–µ–∫—É—â—É—é –∏—Å—Ç–æ—Ä–∏—é (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç)
        const currentIndex = GameData.currentStoryIndex;
        if (GameData.stories && GameData.stories[currentIndex]) {
            GameData.stories[currentIndex].correct = false; // –í—Ä–µ–º—è –∏—Å—Ç–µ–∫–ª–æ = –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
            GameData.stories[currentIndex].answered = true;
            GameData.stories[currentIndex].selectedMistakeId = null; // –ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
            console.log(`‚è∞ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è ${currentIndex} (–≤—Ä–µ–º—è –∏—Å—Ç–µ–∫–ª–æ):`, {
                correct: false,
                answered: true,
                selectedMistakeId: null
            });
        }

        // –í—ã–¥–µ–ª—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
        if (correctMistake) {
            setTimeout(() => {
                const correctOption = document.querySelector(`[data-mistake-id="${correctMistake.id}"]`);
                if (correctOption) {
                    correctOption.classList.add('correct-answer');
                }
            }, 500);
        }

        // –ì–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        const result = {
            correct: false,
            explanation: "–í—Ä–µ–º—è –∏—Å—Ç–µ–∫–ª–æ! " + (correctMistake ? correctMistake.explanation : "–í–∞–∂–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –≤–æ–≤—Ä–µ–º—è."),
            pointsEarned: 0,
            details: {
                base: 0,
                timeBonus: 0,
                difficultyBonus: 0,
                total: 0
            }
        };

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        GameData.result = result;

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        setTimeout(() => {
            if (typeof GameInterface !== 'undefined') {
                GameInterface.showResult(result);
            }
            GameData.isAnswering = false;
        }, 1000);
    }
}

/**
 * –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –æ—Ç–≤–µ—Ç–∞
 * @param {string} mistakeId - ID –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ—à–∏–±–∫–∏
 */
function selectAnswer(mistakeId) {
    // –ï—Å–ª–∏ —É–∂–µ –≤—ã–±–∏—Ä–∞–µ–º –æ—Ç–≤–µ—Ç, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∫–ª–∏–∫–∏
    if (GameData.isAnswering) {
        console.log('–ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–±–æ—Ä –æ—Ç–≤–µ—Ç–∞, —Ç–∞–∫ –∫–∞–∫ —É–∂–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–±–æ—Ä–∞');
        return;
    }

    console.log('–í—ã–±—Ä–∞–Ω –æ—Ç–≤–µ—Ç:', mistakeId);
    GameData.isAnswering = true;
    GameData.answerSelected = true;

    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä - –¥–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
    console.log('–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞ –≤ selectAnswer');
    if (GameData.timer) {
        console.log('–¢–∞–π–º–µ—Ä –Ω–∞–π–¥–µ–Ω, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º...');
        clearInterval(GameData.timer);
        GameData.timer = null;
        console.log('–¢–∞–π–º–µ—Ä —É—Å–ø–µ—à–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –æ—Ç–≤–µ—Ç–∞');
    } else {
        console.warn('–¢–∞–π–º–µ—Ä –Ω–µ –±—ã–ª –Ω–∞–π–¥–µ–Ω –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏. GameData.secondsLeft =', GameData.secondsLeft);
        // –ü—ã—Ç–∞–µ–º—Å—è –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å —Ç–∞–π–º–µ—Ä–æ–º
        const highestIntervalId = setInterval(() => { }, 100000);
        for (let i = 0; i < highestIntervalId; i++) {
            clearInterval(i);
        }
        console.log('–ü–æ–ø—ã—Ç–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã');
    }

    // –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏ —Ç–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
    if (tg && tg.HapticFeedback) {
        tg.HapticFeedback.impactOccurred('medium');
    }

    // –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
    const timeSpent = GameData.timerDuration - GameData.secondsLeft;

    // –ù–∞—Ö–æ–¥–∏–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞
    const selectedMistake = GameData.currentStory.mistakes.find(m => m.id === mistakeId);

    // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
    const correctMistake = GameData.currentStory.mistakes.find(m => m.isCorrect);

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
    const isCorrect = selectedMistake && selectedMistake.isCorrect;

    // ========== –°–û–•–†–ê–ù–Ø–ï–ú –†–ï–ó–£–õ–¨–¢–ê–¢ –í –¢–ï–ö–£–©–£–Æ –ò–°–¢–û–†–ò–Æ ==========
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–≤–µ—Ç–∞ –≤ —Ç–µ–∫—É—â—É—é –∏—Å—Ç–æ—Ä–∏—é
    const currentIndex = GameData.currentStoryIndex;
    if (GameData.stories && GameData.stories[currentIndex]) {
        GameData.stories[currentIndex].correct = isCorrect;
        GameData.stories[currentIndex].answered = true;
        GameData.stories[currentIndex].selectedMistakeId = mistakeId;
        console.log(`‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è ${currentIndex}:`, {
            correct: isCorrect,
            answered: true,
            selectedMistakeId: mistakeId
        });
    }

    // –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –≤—ã–¥–µ–ª—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
    if (!isCorrect && correctMistake) {
        setTimeout(() => {
            const correctOption = document.querySelector(`[data-mistake-id="${correctMistake.id}"]`);
            if (correctOption) {
                correctOption.classList.add('correct-answer');
            }
        }, 500);
    }

    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ—á–∫–∏
    const points = calculatePoints(isCorrect, timeSpent, GameData.currentStory.difficulty);

    // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â–∏–π —Å—á–µ—Ç
    if (isCorrect) {
        GameData.score += points.total;
    }

    // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    const result = {
        correct: isCorrect,
        explanation: isCorrect ? selectedMistake.explanation : correctMistake.explanation,
        pointsEarned: isCorrect ? points.total : 0,
        details: points
    };

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    GameData.result = result;

    // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–ª—è –ª—É—á—à–µ–≥–æ UX
    setTimeout(() => {
        if (typeof GameInterface !== 'undefined') {
            GameInterface.showResult(result);
        }
        GameData.isAnswering = false;
    }, 1000);
}

/**
 * –†–∞—Å—á–µ—Ç –æ—á–∫–æ–≤ –∑–∞ –æ—Ç–≤–µ—Ç
 * @param {boolean} isCorrect - –§–ª–∞–≥ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–∞
 * @param {number} timeSpent - –ó–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
 * @param {string} difficulty - –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–∞
 * @returns {Object} –î–µ—Ç–∞–ª–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –æ—á–∫–æ–≤
 */
function calculatePoints(isCorrect, timeSpent, difficulty) {
    if (!isCorrect) {
        return {
            base: 0,
            timeBonus: 0,
            difficultyBonus: 0,
            total: 0
        };
    }

    // –ë–∞–∑–æ–≤—ã–µ –æ—á–∫–∏ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
    let basePoints = 100;

    // –ë–æ–Ω—É—Å –∑–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
    const timeBonus = Math.max(0, Math.floor((GameData.timerDuration - timeSpent) * 3));

    // –ë–æ–Ω—É—Å –∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å
    let difficultyBonus = 0;
    switch (difficulty) {
        case 'easy':
            difficultyBonus = 0;
            break;
        case 'medium':
            difficultyBonus = 20;
            break;
        case 'hard':
            difficultyBonus = 50;
            break;
    }

    // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—á–∫–æ–≤
    const totalPoints = basePoints + timeBonus + difficultyBonus;

    return {
        base: basePoints,
        timeBonus: timeBonus,
        difficultyBonus: difficultyBonus,
        total: totalPoints
    };
}

/**
 * –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
 */
function nextQuestion() {
    console.log('–ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É');

    // –ï—Å–ª–∏ —ç—Ç–æ –±—ã–ª–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è, –∑–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É
    if (GameData.currentStoryIndex >= GameData.stories.length - 1) {
        console.log('–≠—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å. –ó–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É.');
        finishGame();
        return;
    }

    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ç–∞–π–º–µ—Ä, –µ—Å–ª–∏ –æ–Ω –∞–∫—Ç–∏–≤–µ–Ω
    if (GameData.timer) {
        clearInterval(GameData.timer);
        GameData.timer = null;
    }

    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–π –∏—Å—Ç–æ—Ä–∏–∏
    GameData.currentStoryIndex++;
    GameData.currentStory = GameData.stories[GameData.currentStoryIndex];

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Ñ–ª–∞–≥–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    GameData.isAnswering = false;
    GameData.answerSelected = false;
    GameData.result = null;

    // –°–Ω–∞—á–∞–ª–∞ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    if (typeof GameInterface !== 'undefined') {
        GameInterface.updateUI(GameData);
    }

    // –ü–æ—Ç–æ–º –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –¥–ª—è –Ω–æ–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
    // —á—Ç–æ–±—ã –¥–∞—Ç—å –≤—Ä–µ–º—è –Ω–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    setTimeout(() => {
        startTimer();
    }, 100);
}

/**
 * –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
 */
async function finishGame() {
    console.log('–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã...');

    // ========== –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ò –¢–û–ß–ù–´–ô –†–ê–°–ß–ï–¢ –°–¢–ê–¢–ò–°–¢–ò–ö–ò ==========

    // 1. –ü–û–î–°–ß–ï–¢ –ü–†–ê–í–ò–õ–¨–ù–´–• –û–¢–í–ï–¢–û–í (—Ç–æ–ª—å–∫–æ –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
    let actualCorrectAnswers = 0;
    const totalQuestions = 5; // –í—Å–µ–≥–¥–∞ 5 –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –∏–≥—Ä–µ

    console.log('üîç –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É –≤–æ–ø—Ä–æ—Å—É:');

    if (GameData.stories && GameData.stories.length > 0) {
        GameData.stories.forEach((story, index) => {
            const isCorrect = story.correct === true;
            if (isCorrect) {
                actualCorrectAnswers++;
            }

            console.log(`–í–æ–ø—Ä–æ—Å ${index + 1}:`, {
                id: story.id,
                answered: story.answered,
                correct: isCorrect,
                selectedMistakeId: story.selectedMistakeId
            });
        });
    }

    // 2. –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –§–û–†–ú–£–õ–´ –î–õ–Ø –†–ê–°–ß–ï–¢–ê
    const totalScore = GameData.score || 0;

    // –§–æ—Ä–º—É–ª–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏: (–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã / –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤) √ó 100%
    const accuracy = Math.round((actualCorrectAnswers / totalQuestions) * 100);

    console.log('üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:');
    console.log(`‚Ä¢ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${actualCorrectAnswers} –∏–∑ ${totalQuestions}`);
    console.log(`‚Ä¢ –¢–æ—á–Ω–æ—Å—Ç—å: ${accuracy}%`);
    console.log(`‚Ä¢ –û–±—â–∏–π —Å—á–µ—Ç: ${totalScore} –æ—á–∫–æ–≤`);

    // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏–≥—Ä—ã (–ò–°–ü–û–õ–¨–ó–£–ï–ú –¢–û–õ–¨–ö–û –†–ï–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï)
    const gameResult = {
        totalScore: totalScore,
        correctAnswers: actualCorrectAnswers,
        totalQuestions: totalQuestions
    };

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    GameData.gameResult = gameResult;

    // –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
    try {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        const token = localStorage.getItem('auth_token');

        if (token) {
            // 3. –û–¢–ü–†–ê–í–ö–ê –ù–ê –°–ï–†–í–ï–† —Å —Ç–æ—á–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
            const gameStatistics = {
                gameId: GameData.gameId,
                totalScore: totalScore,
                correctAnswers: actualCorrectAnswers,
                totalQuestions: totalQuestions
            };

            console.log('üì§ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', gameStatistics);

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            const response = await fetch('/api/game/finish', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify(gameStatistics)
            });

            if (response.ok) {
                const data = await response.json();
                console.log('‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–≥—Ä—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:', data);

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–æ–≤—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
                if (data.status === 'success' && data.data.newAchievements && data.data.newAchievements.length > 0) {
                    console.log('üéâ –ü–æ–ª—É—á–µ–Ω—ã –Ω–æ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', data.data.newAchievements);

                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                    if (window.AchievementSystem) {
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                        if (data.data.user && data.data.user.stats) {
                            window.AchievementSystem.updateUserStats({
                                investigations: data.data.user.stats.totalGames || 0,
                                accuracy: data.data.user.stats.accuracy || 0,
                                totalScore: data.data.user.stats.totalScore || 0,
                                winStreak: data.data.user.stats.maxStreak || 0,
                                perfectGames: data.data.user.stats.perfectGames || 0,
                                fastestGame: data.data.user.stats.fastestGame || 999
                            });
                        }

                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö
                        window.AchievementSystem.handleNewAchievements(data.data.newAchievements);
                    } else {
                        console.warn('AchievementSystem –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
                        // Fallback: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                        data.data.newAchievements.forEach(achievement => {
                            if (window.Telegram?.WebApp?.showAlert) {
                                window.Telegram.WebApp.showAlert(`üèÜ –ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${achievement.name}`);
                            } else {
                                alert(`üèÜ –ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${achievement.name}`);
                            }
                        });
                    }
                }
            } else {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:', await response.text());
            }
        } else {
            console.warn('–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–≥—Ä—ã - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
        }
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–≥—Ä—ã:', error);

        // –î–ê–ñ–ï –í –°–õ–£–ß–ê–ï –û–®–ò–ë–ö–ò - –ò–°–ü–û–õ–¨–ó–£–ï–ú –¢–û–õ–¨–ö–û –†–ï–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï
        console.log('üîß –†–µ–∑–µ—Ä–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:');
        console.log(`‚Ä¢ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${actualCorrectAnswers} –∏–∑ ${totalQuestions}`);
        console.log(`‚Ä¢ –°—á–µ—Ç: ${totalScore}`);
    }

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    if (typeof GameInterface !== 'undefined') {
        // –°–æ–∑–¥–∞–µ–º –¥–∏–∞–ª–æ–≥ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏ –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞
        const dialog = document.createElement('div');
        dialog.className = 'game-finish-dialog';
        dialog.innerHTML = `
            <div class="game-finish-content">
                <h2>–†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</h2>
                <p>–í–∞—à —Å—á–µ—Ç: <span class="highlight-score">${gameResult.totalScore}</span> –æ—á–∫–æ–≤</p>
                <p>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${gameResult.correctAnswers} –∏–∑ ${gameResult.totalQuestions}</p>
                <div class="game-finish-buttons">
                    <button id="btnGoHome" class="finish-button">–ì–õ–ê–í–ù–ê–Ø</button>
                    <button id="btnGoProfile" class="finish-button primary">–ü–†–û–§–ò–õ–¨</button>
                </div>
            </div>
        `;

        document.body.appendChild(dialog);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        document.getElementById('btnGoHome').addEventListener('click', () => {
            window.location.href = '/';
        });

        document.getElementById('btnGoProfile').addEventListener('click', () => {
            window.location.href = '/profile.html';
        });

        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –¥–∏–∞–ª–æ–≥–∞, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
        if (!document.getElementById('finish-dialog-styles')) {
            const style = document.createElement('style');
            style.id = 'finish-dialog-styles';
            style.textContent = `
                .game-finish-dialog {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 1000;
                    animation: fadeIn 0.3s ease-out;
                }
                
                .game-finish-content {
                    background: var(--morgue-gray, #2C2C2C);
                    border: 2px solid var(--blood-red, #8B0000);
                    border-radius: 12px;
                    padding: 24px;
                    text-align: center;
                    width: 80%;
                    max-width: 400px;
                    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
                }
                
                .game-finish-content h2 {
                    margin-bottom: 16px;
                    color: var(--chalk-white, #E8E8E8);
                }
                
                .game-finish-content p {
                    margin-bottom: 12px;
                }
                
                .highlight-score {
                    color: var(--crime-scene-yellow, #FFD700);
                    font-weight: bold;
                    font-size: 1.2em;
                }
                
                .game-finish-buttons {
                    display: flex;
                    justify-content: space-between;
                    margin-top: 24px;
                }
                
                .finish-button {
                    flex: 1;
                    margin: 0 8px;
                    padding: 12px;
                    border: 1px solid var(--dried-blood, #5C1010);
                    background: var(--darker-gray, #1E1E1E);
                    color: var(--chalk-white, #E8E8E8);
                    border-radius: 8px;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.2s ease;
                }
                
                .finish-button:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
                }
                
                .finish-button.primary {
                    background: var(--blood-red, #8B0000);
                }
                
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
            `;
            document.head.appendChild(style);
        }
    } else {
        alert(`–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: ${gameResult.totalScore}`);
        window.location.href = '/';
    }
}

// –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
window.selectAnswer = selectAnswer;
window.nextQuestion = nextQuestion;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
document.addEventListener('DOMContentLoaded', () => {
    initApp();
}); 