<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Криминальный Блеф - Игровой процесс</title>

    <!-- Подключение Telegram WebApp API -->
    <script src="https://telegram.org/js/telegram-web-app.js" crossorigin="anonymous"></script>

    <!-- Инициализация объекта TG и проверка наличия Telegram WebApp API -->
    <script>
        // Эта переменная позволит проверить наличие Telegram WebApp API
        window.tgWebAppReady = !!window.Telegram?.WebApp;

        // Для тестирования - создаем заглушку если в тестовом режиме
        if ((!window.Telegram || !window.Telegram.WebApp) &&
            (window.location.host.includes('localhost') || window.location.search.includes('test=true'))) {

            window.Telegram = {
                WebApp: {
                    ready: function () { console.log('WebApp.ready() вызван'); },
                    expand: function () { console.log('WebApp.expand() вызван'); },
                    initData: window.location.search.substring(window.location.search.indexOf('tgWebAppData=') + 12),
                    initDataUnsafe: {
                        user: {
                            id: 12345678,
                            first_name: "Test",
                            last_name: "User",
                            username: "testuser",
                            language_code: "ru"
                        }
                    },
                    BackButton: {
                        show: function () { console.log('BackButton.show() вызван'); },
                        hide: function () { console.log('BackButton.hide() вызван'); },
                        onClick: function (callback) { console.log('BackButton.onClick() установлен'); }
                    },
                    colorScheme: 'dark',
                    HapticFeedback: {
                        impactOccurred: function () { },
                        notificationOccurred: function () { },
                        selectionChanged: function () { }
                    }
                }
            };
            window.tgWebAppReady = true;
        }
    </script>

    <style>
        :root {
            --dark-bg: #0f0f12;
            --card-bg: #1a1a20;
            --accent-red: #d32f2f;
            --accent-yellow: #ffc107;
            --primary-text: #ffffff;
            --secondary-text: rgba(255, 255, 255, 0.7);
            --muted-text: rgba(255, 255, 255, 0.5);
            --highlight-text: #ffc107;
            --border-color: rgba(255, 255, 255, 0.1);
            --success-color: #4caf50;
            --error-color: #f44336;

            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;

            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-full: 9999px;

            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);

            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.2);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.4);

            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            --font-mono: 'SF Mono', 'Roboto Mono', Menlo, Monaco, Consolas, monospace;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: var(--dark-bg);
            color: var(--primary-text);
            font-family: var(--font-sans);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            position: relative;
        }

        /* Background grid pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.01) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.01) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -1;
        }

        .app-container {
            max-width: 450px;
            margin: 0 auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: var(--spacing-md);
            position: relative;
            z-index: 2;
            overflow-x: hidden;
        }

        /* Background subtle gradient */
        .background-gradient {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, rgba(40, 40, 50, 0.8) 0%, rgba(15, 15, 18, 1) 100%);
            z-index: -2;
        }

        /* Header with game status */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            position: relative;
        }

        .case-badge {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            background: var(--card-bg);
            padding: 8px 12px;
            border-radius: var(--radius-full);
            box-shadow: var(--shadow-sm);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .case-icon {
            width: 18px;
            height: 18px;
            color: var(--accent-yellow);
        }

        .case-number {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-text);
            letter-spacing: 0.5px;
        }

        .score-badge {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            background: var(--card-bg);
            padding: 8px 12px;
            border-radius: var(--radius-full);
            box-shadow: var(--shadow-sm);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .score-icon {
            width: 18px;
            height: 18px;
            color: var(--accent-yellow);
        }

        .score-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-text);
            letter-spacing: 0.5px;
        }

        .profile-link {
            background: none;
            border: none;
            color: var(--primary-text);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
        }

        .profile-link:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            background: rgba(40, 40, 50, 1);
        }

        .profile-link:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        .profile-icon {
            width: 20px;
            height: 20px;
            color: var(--accent-yellow);
        }

        /* Ultra Modern High-tech Timer Section */
        .timer-container {
            position: relative;
            margin-bottom: var(--spacing-xl);
            padding: 24px;
            background: linear-gradient(145deg,
                    rgba(15, 15, 25, 0.95),
                    rgba(25, 25, 35, 0.9),
                    rgba(15, 15, 25, 0.95));
            border-radius: 20px;
            backdrop-filter: blur(20px);
            box-shadow:
                0 8px 32px rgba(0, 0, 0, 0.3),
                0 2px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.05),
                inset 0 -1px 0 rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        .timer-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg,
                    rgba(211, 47, 47, 0.05) 0%,
                    rgba(65, 65, 75, 0.05) 50%,
                    rgba(211, 47, 47, 0.05) 100%);
            animation: subtle-glow 4s ease-in-out infinite;
            z-index: 0;
        }

        @keyframes subtle-glow {

            0%,
            100% {
                opacity: 0.3;
            }

            50% {
                opacity: 0.6;
            }
        }

        .timer-label {
            position: relative;
            margin-bottom: 16px;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--accent-red);
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            text-shadow: 0 0 10px rgba(211, 47, 47, 0.6);
            z-index: 2;
        }

        .timer-icon {
            width: 16px;
            height: 16px;
            color: var(--accent-red);
            filter: drop-shadow(0 0 6px rgba(211, 47, 47, 0.7));
            animation: pulse-icon 2s ease-in-out infinite;
        }

        @keyframes pulse-icon {

            0%,
            100% {
                transform: scale(1);
                filter: drop-shadow(0 0 6px rgba(211, 47, 47, 0.7));
            }

            50% {
                transform: scale(1.1);
                filter: drop-shadow(0 0 12px rgba(211, 47, 47, 0.9));
            }
        }

        .timer-outer {
            position: relative;
            height: 60px;
            border-radius: 16px;
            background: linear-gradient(145deg,
                    rgba(5, 5, 15, 0.95),
                    rgba(15, 15, 25, 0.9));
            box-shadow:
                inset 0 4px 12px rgba(0, 0, 0, 0.6),
                inset 0 -2px 8px rgba(255, 255, 255, 0.02),
                0 2px 8px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.08);
            overflow: hidden;
            z-index: 1;
        }

        .timer-section {
            position: relative;
            height: 100%;
            border-radius: 16px;
            overflow: hidden;
            background: radial-gradient(ellipse at center,
                    rgba(10, 10, 20, 0.9) 0%,
                    rgba(5, 5, 15, 0.95) 70%,
                    rgba(0, 0, 10, 1) 100%);
        }

        .timer-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(-45deg,
                    rgba(255, 255, 255, 0.02) 0px,
                    rgba(255, 255, 255, 0.02) 2px,
                    transparent 2px,
                    transparent 8px);
            animation: scan-lines 3s linear infinite;
            z-index: 1;
        }

        @keyframes scan-lines {
            0% {
                transform: translateX(-100%);
            }

            100% {
                transform: translateX(100%);
            }
        }

        .timer-value-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 120px;
            height: 40px;
            border-radius: 12px;
            background: linear-gradient(145deg,
                    rgba(0, 0, 0, 0.9),
                    rgba(15, 15, 25, 0.95),
                    rgba(0, 0, 0, 0.9));
            box-shadow:
                0 4px 20px rgba(0, 0, 0, 0.7),
                0 0 20px rgba(211, 47, 47, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                inset 0 -1px 0 rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(211, 47, 47, 0.4);
            backdrop-filter: blur(10px);
        }

        .timer-value {
            font-size: 22px;
            font-weight: 800;
            color: #ffffff;
            font-family: var(--font-mono);
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            text-shadow:
                0 0 10px rgba(255, 255, 255, 0.8),
                0 0 20px rgba(255, 255, 255, 0.4),
                0 2px 4px rgba(0, 0, 0, 0.5);
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.5));
        }

        .timer-blink {
            color: var(--accent-red);
            animation: advanced-blink 1s ease-in-out infinite;
            display: inline-block;
            transform: translateY(-1px);
            margin: 0 2px;
            text-shadow:
                0 0 8px rgba(211, 47, 47, 0.9),
                0 0 16px rgba(211, 47, 47, 0.6),
                0 0 24px rgba(211, 47, 47, 0.3);
        }

        @keyframes advanced-blink {

            0%,
            100% {
                opacity: 1;
                transform: translateY(-1px) scale(1);
                text-shadow:
                    0 0 8px rgba(211, 47, 47, 0.9),
                    0 0 16px rgba(211, 47, 47, 0.6),
                    0 0 24px rgba(211, 47, 47, 0.3);
            }

            50% {
                opacity: 0.2;
                transform: translateY(-1px) scale(0.95);
                text-shadow:
                    0 0 4px rgba(211, 47, 47, 0.5),
                    0 0 8px rgba(211, 47, 47, 0.3);
            }
        }

        .timer-markers {
            position: absolute;
            top: 8px;
            left: 12px;
            right: 12px;
            height: 8px;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .timer-marker {
            width: 2px;
            height: 4px;
            background: linear-gradient(to top,
                    rgba(255, 255, 255, 0.1),
                    rgba(255, 255, 255, 0.3));
            border-radius: 1px;
            box-shadow: 0 0 4px rgba(255, 255, 255, 0.2);
            opacity: 0;
            animation: marker-fade-in 2s ease-out forwards;
        }

        .timer-marker:nth-child(5n) {
            height: 8px;
            width: 3px;
            background: linear-gradient(to top,
                    rgba(211, 47, 47, 0.3),
                    rgba(255, 71, 71, 0.6),
                    rgba(255, 255, 255, 0.4));
            box-shadow:
                0 0 6px rgba(211, 47, 47, 0.5),
                0 0 12px rgba(211, 47, 47, 0.3);
        }

        @keyframes marker-fade-in {
            0% {
                opacity: 0;
                transform: translateY(4px);
            }

            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Ultra Modern Timer Fill with Holographic Effect */
        .timer-fill {
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
            width: 70%;
            background: linear-gradient(-90deg,
                    rgba(211, 47, 47, 0.9) 0%,
                    rgba(255, 71, 71, 1) 30%,
                    rgba(255, 150, 150, 0.95) 60%,
                    rgba(255, 200, 200, 0.8) 100%);
            animation:
                timer-countdown-rtl 15s linear forwards,
                holographic-flow 3s ease-in-out infinite,
                energy-pulse 2s ease-in-out infinite;
            z-index: 3;
            box-shadow:
                0 0 30px rgba(211, 47, 47, 0.6),
                0 0 60px rgba(211, 47, 47, 0.3),
                inset 0 0 20px rgba(255, 255, 255, 0.4);
            border-radius: 0 16px 16px 0;
            overflow: hidden;
        }

        .timer-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background: linear-gradient(135deg,
                    rgba(255, 255, 255, 0.6) 0%,
                    transparent 30%,
                    transparent 70%,
                    rgba(255, 255, 255, 0.3) 100%);
            animation: shimmer-effect 2.5s ease-in-out infinite;
        }

        .timer-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(45deg,
                    transparent 0px,
                    rgba(255, 255, 255, 0.1) 2px,
                    transparent 4px,
                    transparent 12px);
            animation: diagonal-flow 1.5s linear infinite;
        }

        @keyframes holographic-flow {

            0%,
            100% {
                filter: hue-rotate(0deg) saturate(1.2) brightness(1);
            }

            25% {
                filter: hue-rotate(10deg) saturate(1.4) brightness(1.1);
            }

            50% {
                filter: hue-rotate(-5deg) saturate(1.1) brightness(0.95);
            }

            75% {
                filter: hue-rotate(15deg) saturate(1.3) brightness(1.05);
            }
        }

        @keyframes energy-pulse {

            0%,
            100% {
                box-shadow:
                    0 0 30px rgba(211, 47, 47, 0.6),
                    0 0 60px rgba(211, 47, 47, 0.3),
                    inset 0 0 20px rgba(255, 255, 255, 0.4);
            }

            50% {
                box-shadow:
                    0 0 40px rgba(211, 47, 47, 0.8),
                    0 0 80px rgba(211, 47, 47, 0.5),
                    inset 0 0 30px rgba(255, 255, 255, 0.6);
            }
        }

        @keyframes shimmer-effect {
            0% {
                transform: translateX(-100%) skewX(-15deg);
                opacity: 0;
            }

            20% {
                opacity: 1;
            }

            80% {
                opacity: 1;
            }

            100% {
                transform: translateX(100%) skewX(-15deg);
                opacity: 0;
            }
        }

        @keyframes diagonal-flow {
            0% {
                transform: translateX(-100%);
            }

            100% {
                transform: translateX(100%);
            }
        }

        @keyframes timer-countdown-rtl {
            from {
                width: 100%;
            }

            to {
                width: 0%;
            }
        }

        /* Advanced Ripple Effect */
        .timer-ripple {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle,
                    rgba(255, 255, 255, 0.8) 0%,
                    rgba(255, 255, 255, 0.4) 30%,
                    transparent 70%);
            z-index: 4;
            transform-origin: left center;
            animation: advanced-ripple 2.5s ease-out infinite;
            pointer-events: none;
            border-radius: 16px;
        }

        @keyframes advanced-ripple {
            0% {
                transform: scaleX(0) scaleY(0.8);
                opacity: 0.9;
            }

            30% {
                transform: scaleX(0.3) scaleY(1);
                opacity: 0.7;
            }

            100% {
                transform: scaleX(1.2) scaleY(1.2);
                opacity: 0;
            }
        }

        /* Particle System Enhancement */
        .timer-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 40px;
            height: 100%;
            z-index: 5;
            overflow: hidden;
            animation: timer-countdown-rtl 15s linear forwards;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle,
                    rgba(255, 255, 255, 1) 0%,
                    rgba(255, 200, 200, 0.8) 50%,
                    transparent 100%);
            border-radius: 50%;
            opacity: 0;
            animation: enhanced-particle-float 3s ease-out infinite;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
        }

        .particle:nth-child(1) {
            top: 15%;
            animation-delay: 0.2s;
        }

        .particle:nth-child(2) {
            top: 35%;
            animation-delay: 0.6s;
        }

        .particle:nth-child(3) {
            top: 55%;
            animation-delay: 1.0s;
        }

        .particle:nth-child(4) {
            top: 75%;
            animation-delay: 1.4s;
        }

        .particle:nth-child(5) {
            top: 25%;
            animation-delay: 1.8s;
        }

        @keyframes enhanced-particle-float {
            0% {
                left: 0;
                opacity: 0;
                transform: translateX(0) translateY(0) scale(0.5);
            }

            20% {
                opacity: 1;
                transform: translateX(10px) translateY(-5px) scale(1);
            }

            80% {
                opacity: 0.8;
                transform: translateX(60px) translateY(-15px) scale(0.8);
            }

            100% {
                left: 80px;
                opacity: 0;
                transform: translateX(20px) translateY(-25px) scale(0.3);
            }
        }

        /* Quantum Edge Effect */
        .timer-edge {
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 1) 0%,
                    rgba(255, 200, 200, 0.9) 30%,
                    rgba(211, 47, 47, 0.8) 70%,
                    rgba(255, 255, 255, 1) 100%);
            z-index: 6;
            box-shadow:
                0 0 15px rgba(255, 255, 255, 0.9),
                0 0 30px rgba(255, 255, 255, 0.6),
                0 0 45px rgba(211, 47, 47, 0.4);
            animation:
                timer-countdown-rtl 15s linear forwards,
                quantum-flicker 1.5s ease-in-out infinite;
            border-radius: 2px;
        }

        @keyframes quantum-flicker {

            0%,
            100% {
                opacity: 1;
                transform: scaleY(1) scaleX(1);
                box-shadow:
                    0 0 15px rgba(255, 255, 255, 0.9),
                    0 0 30px rgba(255, 255, 255, 0.6),
                    0 0 45px rgba(211, 47, 47, 0.4);
            }

            15% {
                opacity: 0.7;
                transform: scaleY(0.95) scaleX(1.2);
            }

            30% {
                opacity: 1;
                transform: scaleY(1.05) scaleX(0.9);
            }

            45% {
                opacity: 0.8;
                transform: scaleY(0.98) scaleX(1.1);
            }

            60% {
                opacity: 1;
                transform: scaleY(1.02) scaleX(0.95);
                box-shadow:
                    0 0 20px rgba(255, 255, 255, 1),
                    0 0 40px rgba(255, 255, 255, 0.8),
                    0 0 60px rgba(211, 47, 47, 0.6);
            }

            75% {
                opacity: 0.9;
                transform: scaleY(1) scaleX(1);
            }
        }

        /* Remaining Indicator with Enhanced Styling */
        .remaining-indicator {
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--accent-red);
            font-weight: 600;
            text-shadow: 0 0 8px rgba(211, 47, 47, 0.6);
            position: relative;
            z-index: 2;
        }

        .red-dot {
            width: 8px;
            height: 8px;
            background: radial-gradient(circle,
                    rgba(255, 255, 255, 1) 0%,
                    rgba(211, 47, 47, 1) 30%,
                    rgba(150, 30, 30, 0.8) 100%);
            border-radius: 50%;
            animation: dot-pulse 1.5s ease-in-out infinite;
            box-shadow:
                0 0 10px rgba(211, 47, 47, 0.8),
                0 0 20px rgba(211, 47, 47, 0.4);
        }

        @keyframes dot-pulse {

            0%,
            100% {
                transform: scale(1);
                box-shadow:
                    0 0 10px rgba(211, 47, 47, 0.8),
                    0 0 20px rgba(211, 47, 47, 0.4);
            }

            50% {
                transform: scale(1.3);
                box-shadow:
                    0 0 15px rgba(211, 47, 47, 1),
                    0 0 30px rgba(211, 47, 47, 0.6),
                    0 0 45px rgba(211, 47, 47, 0.3);
            }
        }

        /* Case File Content */
        .case-file {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            box-shadow: var(--shadow-md);
            overflow: hidden;
        }

        .case-file::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--accent-red);
        }

        .case-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: var(--spacing-md);
            letter-spacing: 0.5px;
            color: var(--primary-text);
            text-transform: uppercase;
        }

        .evidence-tag {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(211, 47, 47, 0.2);
            color: var(--accent-yellow);
            font-size: 10px;
            padding: 4px 8px;
            border-radius: var(--radius-sm);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
            backdrop-filter: blur(4px);
        }

        .case-metadata {
            display: flex;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .metadata-item {
            font-size: 12px;
            color: var(--muted-text);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .metadata-icon {
            width: 12px;
            height: 12px;
            opacity: 0.7;
        }

        .case-content {
            font-size: 16px;
            line-height: 1.6;
            color: var(--secondary-text);
            margin-bottom: var(--spacing-md);
        }

        .highlighted-text {
            color: var(--highlight-text);
            font-weight: 500;
        }

        .case-question {
            font-size: 16px;
            font-weight: 600;
            color: var(--highlight-text);
            margin-top: var(--spacing-md);
            padding: var(--spacing-sm) var(--spacing-md);
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-sm);
            border-left: 3px solid var(--highlight-text);
        }

        /* Answer Options */
        .answers-section {
            margin-bottom: var(--spacing-xl);
            position: relative;
        }

        .answers-label {
            position: relative;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--accent-red);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .answers-icon {
            width: 16px;
            height: 16px;
            color: var(--accent-red);
        }

        .answer-option {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-md);
        }

        .answer-option:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            background: rgba(40, 40, 50, 1);
        }

        .answer-option:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        /* Стиль для заблокированных вариантов ответов */
        .answer-option.disabled {
            opacity: 0.7;
            cursor: not-allowed;
            pointer-events: none;
        }

        /* Стиль для выделения правильного ответа при истечении времени */
        .answer-option.correct-answer {
            border-color: var(--success-color);
            background: rgba(76, 175, 80, 0.1);
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);
            opacity: 1;
        }

        .answer-option.correct-answer .answer-marker {
            background: var(--success-color);
            color: var(--dark-bg);
            border-color: var(--success-color);
        }

        .answer-marker {
            width: 28px;
            height: 28px;
            min-width: 28px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--primary-text);
            margin-top: 2px;
            transition: all var(--transition-normal);
        }

        .answer-option:hover .answer-marker {
            background: rgba(255, 255, 255, 0.1);
        }

        .answer-option.selected {
            border-color: var(--accent-yellow);
            background: rgba(255, 193, 7, 0.1);
        }

        .answer-option.selected .answer-marker {
            background: var(--accent-yellow);
            color: var(--dark-bg);
            border-color: var(--accent-yellow);
        }

        .answer-text {
            font-size: 15px;
            line-height: 1.5;
            color: var(--secondary-text);
        }

        .answer-option.selected .answer-text {
            color: var(--primary-text);
        }

        /* Results Section (Initially Hidden) */
        .results-section {
            display: none;
            /* Will be toggled with JS in real app */
            background: var(--card-bg);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            box-shadow: var(--shadow-md);
        }

        .result-correct {
            border-color: var(--success-color);
        }

        .result-correct::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--success-color);
        }

        .result-incorrect {
            border-color: var(--error-color);
        }

        .result-incorrect::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--error-color);
        }

        .result-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 4px 8px;
            border-radius: var(--radius-sm);
        }

        .result-correct .result-badge {
            background: rgba(76, 175, 80, 0.2);
            color: var(--success-color);
        }

        .result-incorrect .result-badge {
            background: rgba(244, 67, 54, 0.2);
            color: var(--error-color);
        }

        .result-header {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            letter-spacing: 0.5px;
        }

        .result-correct .result-header {
            color: var(--success-color);
        }

        .result-incorrect .result-header {
            color: var(--error-color);
        }

        .result-explanation {
            font-size: 15px;
            line-height: 1.6;
            color: var(--secondary-text);
            margin-bottom: var(--spacing-md);
            padding: var(--spacing-sm) var(--spacing-md);
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-sm);
        }

        .result-points {
            font-size: 16px;
            font-weight: 600;
            color: var(--highlight-text);
            padding: var(--spacing-sm) var(--spacing-md);
            background: rgba(255, 193, 7, 0.1);
            border-radius: var(--radius-full);
            display: inline-block;
        }

        .points-value {
            position: relative;
            display: inline-block;
        }

        .points-value::before {
            content: '+';
            margin-right: 2px;
            font-weight: 700;
            color: var(--success-color);
        }

        /* Footer Button */
        .game-footer {
            margin-top: auto;
            padding-top: var(--spacing-md);
        }

        .action-button {
            width: 100%;
            padding: var(--spacing-md);
            background: var(--accent-red);
            color: var(--primary-text);
            border: none;
            border-radius: var(--radius-md);
            font-size: 16px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: #e53935;
            /* Lighter red */
        }

        .action-button:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        .action-button::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .action-button:hover::after {
            left: 100%;
        }

        /* Modern subtle details */
        .glass-effect {
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        /* Crime scene theme elements */
        .crime-scene-pattern {
            position: absolute;
            bottom: 5%;
            right: 5%;
            width: 200px;
            height: 200px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Cpath d='M100 0 C60 0 20 40 20 100 C20 160 60 200 120 200 C160 200 180 180 180 140 C180 100 160 80 120 80 C100 80 80 100 80 120 C80 140 100 160 120 160 C140 160 160 140 160 120' stroke='%23444' stroke-width='0.6' fill='none' opacity='0.04'/%3E%3C/svg%3E");
            opacity: 0.05;
            z-index: -1;
        }

        /* Show results instead of options when answer is selected */
        .answered .answers-section {
            display: none;
        }

        .answered .results-section {
            display: block;
        }

        /* Responsive adjustments */
        @media (max-width: 380px) {
            .case-title {
                font-size: 18px;
            }

            .case-content {
                font-size: 14px;
            }

            .answer-text {
                font-size: 14px;
            }

            .action-button {
                font-size: 14px;
                padding: var(--spacing-sm) var(--spacing-md);
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }
    </style>
</head>

<body>
    <div class="background-gradient"></div>
    <div class="app-container">
        <div class="crime-scene-pattern"></div>

        <header class="game-header">
            <div class="case-badge">
                <svg class="case-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path
                        d="M20 6h-4V4c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zM10 4h4v2h-4V4zm10 16H4V8h16v12z" />
                </svg>
                <span class="case-number">ДЕЛО <span id="question-progress">1/5</span></span>
            </div>

            <div class="score-badge">
                <svg class="score-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 15V3m0 12l-4 4m4-4l4 4M3 12h18" />
                </svg>
                <span class="score-value"><span id="score-display">0</span> ОЧКОВ</span>
            </div>

            <button class="profile-link">
                <svg class="profile-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                </svg>
            </button>
        </header>

        <div class="timer-container">
            <div class="timer-label">
                <svg class="timer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 6v6l4 2" />
                </svg>
                ВРЕМЯ НА РАЗГАДКУ
            </div>
            <div class="timer-outer">
                <div class="timer-section">
                    <div class="timer-background"></div>
                    <div class="timer-noise"></div>
                    <div class="timer-markers">
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                        <div class="timer-marker"></div>
                    </div>
                    <div class="timer-notches">
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                        <div class="timer-notch"></div>
                    </div>
                    <div class="timer-glow"></div>
                    <div class="timer-fill" id="timer-bar"></div>
                    <div class="timer-ripple"></div>
                    <div class="timer-particles">
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                    </div>
                    <div class="timer-edge"></div>
                    <div class="timer-scanline"></div>
                    <div class="laser-sight"></div>
                    <div class="timer-value-container">
                        <div class="timer-value"><span id="timer-value">15</span><span class="timer-blink">:</span>00
                        </div>
                    </div>
                </div>
            </div>
            <div class="remaining-indicator">
                <span class="red-dot"></span>
                ВРЕМЯ ИДЕТ
            </div>
        </div>

        <section class="case-file glass-effect">
            <div class="evidence-tag">УЛИКА #<span id="story-evidence-id">01</span></div>
            <h2 class="case-title" id="story-title">ОГРАБЛЕНИЕ ЮВЕЛИРНОГО МАГАЗИНА</h2>

            <div class="case-metadata">
                <div class="metadata-item">
                    <svg class="metadata-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                        <line x1="16" y1="2" x2="16" y2="6" />
                        <line x1="8" y1="2" x2="8" y2="6" />
                        <line x1="3" y1="10" x2="21" y2="10" />
                    </svg>
                    <span id="story-date">12.04.2024</span>
                </div>
                <div class="metadata-item">
                    <svg class="metadata-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                    </svg>
                    <span id="story-difficulty">СЛОЖНОСТЬ: СРЕДНЯЯ</span>
                </div>
            </div>

            <div class="case-content" id="story-content">
                Преступник взломал заднюю дверь ювелирного магазина в 3 часа ночи. Он отключил камеры видеонаблюдения,
                но не заметил <span class="highlighted-text">скрытую камеру над сейфом</span>. На записи видно, как он
                <span class="highlighted-text">без перчаток</span> открывает витрины и собирает украшения в рюкзак.
                Перед уходом преступник воспользовался <span class="highlighted-text">раковиной в подсобке</span>, чтобы
                смыть кровь с пореза на руке.
            </div>

            <div class="mission-container">
                <div class="mission-line"></div>
                <div class="mission-question">Какую роковую ошибку допустил преступник?</div>
            </div>
        </section>

        <section class="answers-section">
            <div class="answers-label">
                <svg class="answers-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path
                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                </svg>
                ВАРИАНТЫ ОТВЕТОВ
            </div>

            <div id="answers-container">
                <div class="answer-option" data-mistake-id="mistake-1" data-action="selectAnswer">
                    <div class="answer-marker">A</div>
                    <div class="answer-text">
                        Неправильно отключил систему видеонаблюдения, не заметив скрытую камеру
                    </div>
                </div>

                <div class="answer-option" data-mistake-id="mistake-2" data-action="selectAnswer">
                    <div class="answer-marker">B</div>
                    <div class="answer-text">
                        Работал без перчаток, оставив отпечатки пальцев на витринах и украшениях
                    </div>
                </div>

                <div class="answer-option" data-mistake-id="mistake-3" data-action="selectAnswer">
                    <div class="answer-marker">C</div>
                    <div class="answer-text">
                        Оставил свои биологические следы, смыв кровь в раковине, что позволило получить его ДНК
                    </div>
                </div>
            </div>
        </section>

        <section class="results-section result-correct" id="result-section" style="display:none">
            <div class="result-badge" id="result-badge">ВЕРНО</div>

            <h3 class="result-header" id="result-header">Правильно!</h3>
            <div class="result-explanation" id="result-explanation">
                Преступник оставил биологический материал (кровь), который попал в слив раковины. Даже после смывания,
                следы ДНК остаются на сантехнике и в трубах. Криминалисты легко извлекают такие образцы и используют для
                идентификации. Современные методы могут выделить ДНК-профиль даже из микроскопических следов крови.
            </div>
            <div class="result-points" id="result-points"><span class="points-value">120</span> ОЧКОВ</div>
        </section>

        <footer class="game-footer">
            <button class="action-button" id="action-button" data-action="nextQuestion">СЛЕДУЮЩЕЕ ДЕЛО</button>
        </footer>
    </div>

    <!-- Скрипты игры -->
    <script src="achievement-system.js"></script>
    <script src="game-interface.js"></script>
    <script src="crime-app.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Инициализация Telegram WebApp
            if (window.Telegram?.WebApp) {
                // Расширяем WebApp
                window.Telegram.WebApp.expand();

                // Показываем кнопку "Назад" при запуске игры
                window.Telegram.WebApp.BackButton.show();

                // Настраиваем обработчик кнопки "Назад"
                window.Telegram.WebApp.BackButton.onClick(function () {
                    if (confirm('Вы уверены, что хотите прервать игру?')) {
                        window.location.href = '/';
                    }
                });
            }

            // Обработчики событий для элементов игрового интерфейса
            document.querySelectorAll('.answer-option').forEach(function (option) {
                option.addEventListener('click', function () {
                    // Получаем ID ошибки из атрибута data-mistake-id
                    const mistakeId = this.getAttribute('data-mistake-id');

                    // Удаляем класс selected у всех опций
                    document.querySelectorAll('.answer-option').forEach(function (opt) {
                        opt.classList.remove('selected');
                    });

                    // Добавляем класс selected к выбранной опции
                    this.classList.add('selected');

                    // Визуальный и тактильный отклик
                    if (window.Telegram?.WebApp?.HapticFeedback) {
                        window.Telegram.WebApp.HapticFeedback.impactOccurred('medium');
                    }

                    // Проверяем, является ли выбранный ответ правильным
                    const isCorrect = mistakeId === 'mistake-3'; // В данном примере правильный ответ всегда C

                    // Показываем раздел с результатом
                    const resultSection = document.getElementById('result-section');
                    resultSection.style.display = 'block';

                    if (isCorrect) {
                        resultSection.className = 'results-section result-correct';
                        document.getElementById('result-badge').textContent = 'ВЕРНО';
                        document.getElementById('result-header').textContent = 'Правильно!';
                        document.getElementById('result-explanation').textContent = 'Преступник оставил биологический материал (кровь), который попал в слив раковины. Даже после смывания, следы ДНК остаются на сантехнике и в трубах. Криминалисты легко извлекают такие образцы и используют для идентификации.';
                        document.getElementById('result-points').innerHTML = '<span class="points-value">120</span> ОЧКОВ';
                    } else {
                        resultSection.className = 'results-section result-incorrect';
                        document.getElementById('result-badge').textContent = 'ОШИБКА';
                        document.getElementById('result-header').textContent = 'Неправильно!';
                        document.getElementById('result-explanation').textContent = 'Преступник оставил биологический материал (кровь), который попал в слив раковины. Даже после смывания, следы ДНК остаются на сантехнике и в трубах. Криминалисты легко извлекают такие образцы и используют для идентификации.';
                        document.getElementById('result-points').innerHTML = '<span class="points-value">0</span> ОЧКОВ';
                    }
                });
            });

            // Обработчик кнопки "Следующее дело"
            document.getElementById('action-button').addEventListener('click', function () {
                // В реальном приложении здесь был бы переход к следующему делу

                // или window.location.href = '/game?next=true';
            });

            // Запускаем таймер
            let secondsLeft = 15;
            const timer = setInterval(function () {
                secondsLeft--;
                document.getElementById('timer-value').textContent = secondsLeft;
                document.getElementById('timer-bar').style.width = (secondsLeft / 15 * 100) + '%';

                if (secondsLeft <= 5) {
                    document.querySelector('.timer-container').classList.add('urgent');

                    // Тактильный отклик при низком времени
                    if (window.Telegram?.WebApp?.HapticFeedback) {
                        window.Telegram.WebApp.HapticFeedback.notificationOccurred('warning');
                    }
                }

                if (secondsLeft <= 0) {
                    clearInterval(timer);

                }
            }, 1000);

            // Сообщаем Telegram, что приложение готово
            if (window.Telegram?.WebApp) {
                window.Telegram.WebApp.ready();
            }
        });
    </script>
</body>

</html>